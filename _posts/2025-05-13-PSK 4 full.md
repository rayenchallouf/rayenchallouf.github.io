---
title: PSK 4 full
categories: [Matlab]
tags: [code, easy]
---

## MATLAB Code

Below is the MATLAB code for the simulation:

```matlab
clc
clear
N = 100000;
RSB = 0:2:20;

for h = 1:length(RSB)
x = randn(1, N);
    for i = 1:length(x)
        if x(i) > 0
            x(i) = 1;
        else
            x(i) = 0;
        end
    end
    k = 0;
    for i = 1:2:(length(x) - 1)
        k = k + 1;
        if x(i) == 0
            if x(i + 1) == 0
                xmod(k) = (-(sqrt(2)/2))-(j*((sqrt(2)/2)));
            else
                xmod(k) = (-(sqrt(2)/2))+(j*((sqrt(2)/2)));
            end
        else
            if x(i + 1) == 0
                xmod(k) = (sqrt(2)/2)-(j*((sqrt(2)/2)));
            else
                xmod(k) = (sqrt(2)/2)+(j*((sqrt(2)/2)));
            end
        end
    end
    sigma = (1 / sqrt(2)) * (10^(-RSB(h) / 40));
    bruit = sigma * randn(1, length(xmod));
    y = xmod + bruit;
    y;
    plot(real(y), imag(y), '+')

    k = 1;
    for i = 1:length(xmod)

        if real(y(i))<0 && imag(y(i))<0
            xdemod(k) = 0;
            xdemod(k + 1) = 0;
        end
        if real(y(i))<0 && imag(y(i))>0
            xdemod(k) = 0;
            xdemod(k + 1) = 1;
        end
        if real(y(i))>0 && imag(y(i))<0
            xdemod(k) = 1;
            xdemod(k + 1) = 0;
        end
        if real(y(i))>0 && imag(y(i))>0
            xdemod(k) = 1;
            xdemod(k + 1) = 1;
        end
        k = k + 2;

    end
    xdemod;
    nb = 0;
    for i = 1:length(x)
        if x(i) ~= xdemod(i)
            nb = nb + 1;
        end
    end

    TEB(h) = nb / N;
end


figure(1)
plot(real(xmod), imag(xmod), 'o')
figure(2)
plot(real(xdemod), imag(xdemod), 'o')
figure(3)
plot(RSB,TEB)
figure(4)
semilogy(RSB,TEB)

```
